@using Newtonsoft.Json
@model HotelGuestVerifyByPolice_CMS.Areas.Department.Models.DeptDashboardRes
@{
    Layout = "_DepartLayout";
    ViewData["Title"] = "Dashboard";
}
<link rel="stylesheet" href="/Areas/HotelDashboard/Content/css/Layout_CSS.css" />
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<script src="https://cdn.datatables.net/1.10.9/js/jquery.dataTables.min.js"></script>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB7w-l0RWEUVqhXyshtsgdkqJDNxaKQ5lY&callback" async defer></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<link rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
<link rel="stylesheet" href="https://unpkg.com/flickity@2/dist/flickity.min.css" />
<script src="https://unpkg.com/flickity@2/dist/flickity.pkgd.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.4.2/js/dataTables.buttons.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.4.2/js/buttons.html5.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"></script>
<style>
    [aria-label="Show satellite imagery"], [aria-label="Show street map"] {
        font-size:12px !important;
        height: 25px !important;
    }
    [role="menu"]{
        padding:0px !important;
    }

    [aria-label="Labels"], [aria-label="Terrain"] {
        font-size: 12px !important;
    }
    wordtune-read-extension {
        display: none
    }

    body {
        margin: 0px;
        padding: 0px
    }
    h6{font-size:14px}
    
    .nav-bg {
        background-image: linear-gradient( 45deg, hsl(264deg 73% 38%) 0%, hsl(259deg 68% 39%) 16%, hsl(253deg 64% 40%) 32%, hsl(247deg 61% 41%) 49%, hsl(241deg 58% 42%) 66%, hsl(234deg 65% 40%) 83%, hsl(228deg 78% 36%) 100% ) !important;
    }

    .navbar-header a span {
        color: #fff;
        margin-left: 25px;
        font-size: 16px
    }

    .ml-auto {
        margin-left: auto
    }

    #nav-details span {
        color: #fff;
        margin-right: 12px;
    }

   /*  #userDetails {
        background: #1831a5;
        /* #847cff */
        /*border-radius: 5px;
        color: #fff;
    } */
    #userDetails{
        background: #ffffff;
        border-radius: 5px;
        color: #0a0a0a;
       /*  box-shadow: 1px 3px 9px 0px #3e27a8; */
        /* box-shadow: 1px 3px 9px 0px #189ea5; */
        box-shadow: inset 0px -4px 4px 0px #511ca8;
         margin-bottom: 9%;
    }
    th {
        /* background: #1831a5; */
        background: #11b7bf;
        font-weight: 500;
        padding: 4px;
        color: #fff;
        min-width: 75px;
    }

    tbody, td, tfoot, thead, tr {
        font-size: 11px;
        text-align: center;
        padding: 4px;
        /*  background: #220a52; */
        background: #fff;
        color: #303030;
    }

    table td:nth-child(3) {
        color: #0ca10c
    }

    table td:nth-child(4) {
        color: #cb0000
    }

    .card {
        margin: 0 -8px 13px -8px;
        color: rgba(0, 0, 0, 0.87);
        box-shadow: 2px 2px 8px rgb(0 0 0 / 31%);
        background: #fff;
        border-radius: 20px;
    }

    .guestDetails {
        padding-top: 2%;
        padding-left: 2%;
        padding-bottom: 1%;
    }

        .guestDetails h6 {
        }

        .guestDetails h6 {
            font-size: 12px;
            margin-bottom: 4px
        }

    .dataTime {
        font-size: 12px
    }

    #secRow {
        display: none
    }

    #hideSecRow {
        display: none
    }

    .width {
        width: 122px !important
    }


    .modelHeading{
        font-size:14px;
        font-weight:400;
        margin-bottom:10px;
        width: 150px;
    }
    .modelData{
        margin-bottom: 10px;
    }
    /*Tabs*/
    .tabs.active h6{color:#11b7bf!important}
    fieldset {
        display: none;
    }

        fieldset.show {
            display: block;
        }

    .tabs {
        margin: 2px 5px 0px 5px;
        padding-top: 10px;
        cursor: pointer;
    }

        .tabs:hover, .tabs.active {
            border-bottom: 1px solid #2196F3;
        }

    #imageDisplay
    {
        width : 50px;
        height : 50px;
        border-radius : 50%;
    }

    #addOnGuestDetailsModal ,#addOnGuestDetailsModalDoc{
        display:none;
    }
    .modal{
        right:0;
        transition: 0.5s; /* Add a transition for smooth opening */
        animation: fadeInRight;
        animation-duration: 1s;
    }

    .modal.right .modal-dialog {
        position: fixed;
        margin: auto;
        height: 100%;
        -webkit-transform: translate3d(0%, 0, 0);
        -ms-transform: translate3d(0%, 0, 0);
        -o-transform: translate3d(0%, 0, 0);
        transform: translate3d(0%, 0, 0);
    }

    .modal.right .modal-content {
        height: 100%;
        overflow-y: auto;
    }

    .modal.right .modal-body {
        padding: 15px 15px 80px;
    }
    /*Right*/
    .modal.right .modal-dialog {
        right: 0px;
        -webkit-transition: opacity 0.3s linear, right 0.3s ease-out;
        -moz-transition: opacity 0.3s linear, right 0.3s ease-out;
        -o-transition: opacity 0.3s linear, right 0.3s ease-out;
        transition: opacity 0.3s linear, right 0.3s ease-out;
           
        }
         .fade-out {
            
            animation:fadeOutRight;
        animation-duration: 2s;
        }

       
    #showallguestdetails{
        width:100%;
    }

    /* ===== Scrollbar CSS ===== #189ea5*/
    /* Firefox */
    * {
        scrollbar-width: auto;
        scrollbar-color:#c7c7c7 #e9e2e2;
    }

        /* Chrome, Edge, and Safari */
    .tableDesign::-webkit-scrollbar {
            width: 10px;
        }

    .tableDesign::-webkit-scrollbar-track {
            background: #fff;
        }

    .tableDesign::-webkit-scrollbar-thumb {
        background-color: #c7c7c7;
            border-radius: 10px;
        border: 1px groove #d6d6d6;
        }
        .tableDesign{
            display:block;overflow-y:auto;height:260px;border: 1px solid rgb(206 212 241);border-radius:5px;box-shadow: 2px 2px 8px rgb(0 0 0 / 31%);
        }
        .card-padding{
        padding: 0px 15px;
        }

    .cardDeatils{padding:10px 40px;}

    .cardImage{
        padding: 25px;
        width: 200px;
        height: 210px;
    }
   .dt-button {
       border:1px solid #bfbdbd;
       border-radius:5px;
   }
   table.dataTable thead th, table.dataTable thead td{padding:5px}

  /*   .tab011{display:block} */
  .btn-orange{
        color: #511ba7;
        /* border-color: #ff7e33; */
        font-size: 13px;
        font-weight: 600;
  }

    #addOnGuestList li{
        font-size:14px
    }
</style>


<div>
    @*  <div class="px-6 nav-bg" style="width:100%;height:50px">

    <div class="container-fluid" style="padding-top:1%;">
    <div class="navbar-header" style="display:inline" >
    <a href="/Department/DepartmentHome/Index">   <span><i class="fa-solid fa-house" style="color: #ffffff;margin-right: 10px"></i>Dashboard</span></a>
    <a href="/Department/DepartmentHome/SearchHotel"> <span><i class="fa-solid fa-hotel" style="color:#fff;margin-right: 10px"></i>Find Hotels Details</span></a>
    </div>
    <div style="float:right;padding-right:40px" id="nav-details">
    <span id="showSecRow"><img src="../Areas/HotelDashboard/Content/Images/Icon/maximize_(1).png" style="width:24px;"/></span>
    <span id="hideSecRow"><img src="../Areas/HotelDashboard/Content/Images/Icon/minimize.png" style="width:24px;" /></span>
    <span>Live </span>
    <span style="display:inline-block;background:red;height:15px;width:15px;border-radius:50%"></span>
    <span><i class="fa-regular fa-bell" style="color: #ffffff;"></i></span>
    <span style="color:#fff;font-size:16px;">
    @if (ViewBag.departuser != null)
    {
    @ViewBag.departuser
    }
    else
    {

    }
    </span>

    <span onclick="logout()"><i class="fa-solid fa-right-from-bracket" style="color:#fff"></i></span>
    </div>
    </div>

    </div> *@
    <div class="row mx-1 py-2">
        <div class="col-md-3 col-lg-3 animate__animated animate__fadeInLeft">
            <div id="userDetails" class="py-3">
                <h4 class="text-center">
                    @if (ViewBag.departuser != null)
                    {
                        @ViewBag.departuser
                    }
                    else
                    {

                    }
                </h4>
                <h4 class="text-center">@Model.stationName</h4>
            </div>

            <div class="mt-1" style="background:#11b7bf;border-radius:5px;box-shadow: 2px 2px 8px rgb(0 0 0 / 31%)">
                <h3 class="text-white text-center py-1">Hotels Locations</h3>
                <div id="map" style="height: 220px;width:100%"></div>
            </div>
            <div class="mt-4 scrollbar">
                <table id="example" class="display tableDesign" cellspacing="0" width="100%" style="height:210px;">
                    <thead>
                        <tr>
                            <th style="min-width: 155px;">Police Station</th>
                            <th>Hotels</th>
                            <th>Total Check-In</th>
                            <th>Today Check-In</th>
                            <th>Today Check-Out</th>

                        </tr>
                    </thead>

                    <tbody>
                        @foreach (var hldfd in Model.hotelListDetailsForDashboards)
                        {
                            <tr>
                                <td>@hldfd.stationName</td>
                                <td>@hldfd.hotelCount</td>
                                <td>@hldfd.totalCheckIn</td>
                                <td>@hldfd.todaysCheckIn</td>
                                <td>@hldfd.todaysCheckOut</td>

                            </tr>
                        }

                    </tbody>
                </table>
            </div>
        </div>
        <div class="col-md-9 col-lg-9">
            @*  <marquee direction="up" onmouseover="this.stop();" onmouseout="this.start();"> *@
            <div class="carousel">
            @for (var i = 0; i < Model.hotelGuestDetails_DeptDashes.Count; i += 2)
            {
               
                    <div class="row cardDeatils carousel-cell">
                    <div class="col-md-6 col-lg-6 card-padding">
                            <div class="card animate__animated animate__fadeInDown">
                            <div class="d-flex">
                                <div>
                                    @if (@Model.hotelGuestDetails_DeptDashes[i].guestPhoto == null)
                                    {
                                            <img src="/Areas/Department/Content/Images/Icons/avatars.jpg" class="cardImage" />
                                    }
                                    else
                                    {

                                            <img src="data:image/jpeg;base64,@Convert.ToBase64String(@Model.hotelGuestDetails_DeptDashes[i].guestPhoto)" alt="Image" class="cardImage" />
                                    }

                                </div>
                                <div class="guestDetails">
                                    <h5>@Model.hotelGuestDetails_DeptDashes[i].guestName</h5>
                                    <h6>Age : @Model.hotelGuestDetails_DeptDashes[i].age</h6>
                                    <h6>City : @Model.hotelGuestDetails_DeptDashes[i].city</h6>
                                    <h6>Purpose : @Model.hotelGuestDetails_DeptDashes[i].visitPurpose</h6>
                                    <h6>Comeing From : @Model.hotelGuestDetails_DeptDashes[i].comingFrom</h6>
                                    <h6>Reservation : @Model.hotelGuestDetails_DeptDashes[i].reservation</h6>

                                    <h6>@Model.hotelGuestDetails_DeptDashes[i].hotelName</h6>
                                        <h6 style="color:green">Check-In</h6>
                                    <h5 class="dataTime">@Model.hotelGuestDetails_DeptDashes[i].checkInDate</h5>

                                    <h6>Remark : </h6>
                                    @* <h6 style="text-align:end">View All</h6> *@
                                        <div style="text-align:end"> <a class="btn btn-orange" data-toggle="modal" id="viewmodal" data-div-id="@Model.hotelGuestDetails_DeptDashes[i].roomBookingID">View Details</a></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    @if (i + 1 < Model.hotelGuestDetails_DeptDashes.Count)
                    {
                        <div class="col-md-6 col-lg-6 card-padding">
                                <div class="card animate__animated animate__fadeInDown">
                                <div class="d-flex">
                                    <div>
                                        @if (@Model.hotelGuestDetails_DeptDashes[i + 1].guestPhoto == null)
                                        {
                                                <img src="/Areas/HotelDashboard/Content/Images/Icon/avatars-000396781371-h4mpjo-t500x500.jpg" class="cardImage" />
                                        }
                                        else
                                        {

                                                <img src="data:image/jpeg;base64,@Convert.ToBase64String(@Model.hotelGuestDetails_DeptDashes[i + 1].guestPhoto)" alt="Image" class="cardImage" />
                                        }

                                    </div>
                                    <div class="guestDetails">
                                        <h5>@Model.hotelGuestDetails_DeptDashes[i + 1].guestName</h5>
                                        <h6>Age : @Model.hotelGuestDetails_DeptDashes[i + 1].age</h6>
                                        <h6>City : @Model.hotelGuestDetails_DeptDashes[i + 1].city</h6>
                                        <h6>Purpose : @Model.hotelGuestDetails_DeptDashes[i + 1].visitPurpose</h6>
                                        <h6>Comeing From : @Model.hotelGuestDetails_DeptDashes[i + 1].comingFrom</h6>
                                        <h6>Reservation : @Model.hotelGuestDetails_DeptDashes[i + 1].reservation</h6>

                                        <h6>@Model.hotelGuestDetails_DeptDashes[i + 1].hotelName</h6>
                                        <h6 style="color:green">Check-In</h6>
                                        <h5 class="dataTime">@Model.hotelGuestDetails_DeptDashes[i + 1].checkInDate</h5>

                                        <h6>Remark : </h6>
                                        @*  <h6 style="text-align:end">View All</h6> *@
                                            <div style="text-align:end"> <a class="btn btn-orange" data-toggle="modal" data-div-id="@Model.hotelGuestDetails_DeptDashes[i + 1].roomBookingID">View Details</a></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    }
                </div>

                }
            </div>
            @*    </marquee> *@

            <!-- The Modal -->
            <div class="modal right" id="resultModal">
                <div class="modal-dialog" id="showallguestdetails">
                    <div class="modal-content">



                        <div class="modal-header">
                            <div class="container-fluid">
                                <div class="row">
                                    <div class="col-md-2" style="margin-left: -25px;">
                                        <button type="button" class="close" onclick="animateModalClose()" style="font-size: 30px;">&times;</button>
                                    </div>
                                  
                                    <div class="col-md-10" style="margin-top: 35px;margin-left: -20px;">
                                        <img id="imageDisplay" src="" alt="Image"/>
                                        <span id="title"></span>
                                         <span id="rbookid" style="display:none"></span>
                                        <span id="title" style="margin-left:6%"></span>
                                    </div>
                                
                                </div>
                                <div class="row">
                                    <div class="col-md-3 tabs active" id="tab01">
                                        <h6 class="text-muted">Guest Details</h6>
                                    </div>
                                    <div class="col-md-3 tabs" id="tab02">
                                        <h6 class="text-muted">Stay Details</h6>
                                    </div>
                                    <div class="col-md-3 tabs" id="tab03">
                                        <h6 class="text-muted">Documents</h6>
                                    </div>
                                 
                                </div>
                            </div>
                         
                        </div>
                        <div class="modal-body">
                            <!-- API result will be displayed here -->
                            <div id="apiResult"></div>
                            <fieldset id="tab011">
                                <h3 class="mb-3 mt-2">CONTACT INFORMATION</h3>
                                <div class="d-flex">
                                    <div>
                                        <h6 class="modelHeading">Guest Name  </h6>


                                        <h6 class="modelHeading">Mobile  </h6>


                                        <h6 class="modelHeading">Email  </h6>


                                        <h6 class="modelHeading">Gender   </h6>


                                        <h6 class="modelHeading">Age </h6>



                                      @*   <div id="addOnGuestDetailsModal">
                                            <h3>FAMAILY MEMBER</h3>



                                            <ul id="addOnGuestList"></ul>


                                        </div> *@
                                    </div>
                                    <div>
                                        <h6 id="name" class="modelData"></h6>
                                        <h6 id="mobile" class="modelData"></h6>
                                        <h6 id="email" class="modelData"></h6>
                                        <h6 id="gender" class="modelData"></h6>
                                        <h6 id="age" class="modelData"></h6>
                                    </div>
                                </div>
                                <h3 class="mb-3 mt-4">ADDRESS</h3>
                                <div class="d-flex">
                                    <div>
                                        <h6 class="modelHeading">Country  </h6>


                                        <h6 class="modelHeading">City  </h6>


                                        <h6 class="modelHeading">Address  </h6>


                                       
                                    </div>
                                    <div>
                                        <h6 id="country" class="modelData"></h6>
                                        <h6 id="city" class="modelData"></h6>
                                        <h6 id="addr" class="modelData"></h6>
                                       
                                    </div>
                                </div>
                                <h3 class="mb-3 mt-4">FAMAILY MEMBER</h3>
                                <div id="addOnGuestDetailsModal">
                                    <ul id="addOnGuestList"></ul>

                                </div>
                               
                               
                              
                                
                            </fieldset>

                            <fieldset id="tab021">
                                <h3 class="mb-3 mt-4">STAY INFORMATION</h3>
                                <div class="d-flex">
                                    <div>
                                        <h6 class="modelHeading">Night Stayed  </h6>


                                        <h6 class="modelHeading">Last Visit  </h6>


                                     



                                    </div>
                                    <div>
                                        <h6 id="nightstayed" class="modelData"></h6>
                                        <h6 id="lastvisit" class="modelData"></h6>
                                       

                                    </div>
                                </div>
                               
                            </fieldset>

                            <fieldset id="tab031">
                                <h3>DOCUMENTS </h3>
                                <h6><span class="modelHeading" style="margin-right: 5%;">Guest Name </span><span id="dmainname"></span></h6>
                                  
                                  <br />
                                  <button id="downloadButton" class="btn btn-md btn-primary">Download PDF</button>
                                <iframe id="pdfPreview" width="100%" height="500" style="display: none;"></iframe>
                            
                                  <div class="row">
                                      <div class="col-md-6">
                                          <h6>Guest Photo</h6>
                                           <img id="dimageDisplay" src="" alt="Image" style="width:100%"/>
                                      </div>
                                      <div class="col-md-6">
                                          <h6>Guest ID Photo</h6>
                                        <img id="mainGuestIdProof" src="" alt="Image" style="width:100%" />
                                      </div>

                                  </div>
                                    <div id="addOnGuestDetailsModalDoc">
                                        <div id="addguestDoc">

                                        </div>
                                      @*    <div class="row">
                                              <div class="col-md-6">
                                                  <h6>Guest Photo</h6>
                                                   <img id="addOnGuestImg" src="" alt="Image"/>
                                              </div>
                                              <div class="col-md-6">
                                                  <h6>Guest ID Photo</h6>
                                                  <img id="addonGuestIdProof" src="" alt="Image"/>
                                              </div>

                                          </div> *@
                                    </div>
                            </fieldset>


                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" onclick="animateModalClose()">Close</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="mt-2">
                <table id="guestTable" class="display tableDesign" cellspacing="0" >
                    <thead>
                        <tr>
                            <th class="width">Hotel Name</th>
                            <th class="width">Guest Name</th>
                            <th class="width">Age</th>
                            <th class="width">Purpose</th>
                            <th class="width">Coming From </th>
                            <th class="width">Reservation</th>
                            <th class="width">Contact</th>
                            <th class="width">City</th>
                            <th class="width">Check-in</th>
                        </tr>
                    </thead>

                    <tbody>
                        @foreach (var hgdt in Model.hotelGuestDetails_DeptDashes2)
                        {
                            <tr>
                                <td>@hgdt.hotelName</td>
                                <td>@hgdt.guestName</td>
                                <td>@hgdt.age</td>
                                <td>@hgdt.visitPurpose</td>
                                <td>@hgdt.comingFrom</td>
                                <td>@hgdt.reservation</td>
                                <td>@hgdt.mobile</td>
                                <td>@hgdt.city</td>
                                <td>@hgdt.checkInDate</td>

                            </tr>
                        }


                    </tbody>
                </table>
            </div>
        </div>

    </div>




</div>

<script>
   
</script>

<script>


    $(document).ready(function () {
        // var elem = document.querySelector('.carousel');
        // var flkty = new Flickity(elem, {
        //     // options
        //     cellalign: 'right',
        //     pageDots: false,
        //     groupCells: '40%',
        //     selectedAttraction: 0.03,
        //     friction: 0.65
        // });
        // var flkty = new Flickity('.carousel', {
        //     // options
        // });
         $("#showSecRow").click(function () {
            $(".cardDeatils:eq(1)").show();

            $("#showSecRow").hide();
            $("#hideSecRow").show();

        });
        var html = $(".cardDeatils:eq(1)").html();
        $("#hideSecRow").click(function () {
            $(".cardDeatils:eq(1)").hide();
            $("#showSecRow").show();
            $("#hideSecRow").hide();
            //console.log(html)

        });
        initMap();
        $('[id="viewmodal"]').click(function () {
            alert();
            const divId = $(this).data('div-id');
            const dataToSend = `divId=${divId}`;
              var showAddOnDetails = document.getElementById('addOnGuestDetailsModal');
              var showAddOnDetailsDoc = document.getElementById('addOnGuestDetailsModalDoc');
            const addOnGuestListElement = document.getElementById("addOnGuestList");
            const addOnGuestDocElement = document.getElementById("addguestDoc");
            debugger;
            // Make a POST request to your server route with data as a string using $.ajax
            $.ajax({
                type: 'POST',
                url: '/Department/DepartmentHome/ShowHotelGuestDetails',
                data: { roombookingId: divId },
                success: function (data) {
                    $('#resultModal').modal('show');
                    $("#tab011").addClass("show");
                    
                    console.log(data);
                    
                    var imageSrc = data.hotelGuestDetails[0].guestPhoto;
                    var imageSrcIdProof = data.hotelGuestDetails[0].guestIdPhoto;
                    var default_img = '/Areas/Department/Content/Images/Icons/avatars.jpg';
                    //console.log(imageSrc);
                    if (imageSrc != null) {
                        $("#imageDisplay").attr("src", "data:image/jpeg;base64," + imageSrc);
                        $("#dimageDisplay").attr("src", "data:image/jpeg;base64," + imageSrc);
                    }
                    else
                    {
                        $("#imageDisplay").attr("src", default_img);
                        $("#dimageDisplay").attr("src", default_img);
                    }
                    if (imageSrcIdProof != null) {
                        $("#mainGuestIdProof").attr("src", "data:image/jpeg;base64," + imageSrcIdProof);
                    }
                    else
                    {
                        $("#mainGuestIdProof").attr("src", default_img);
                    }
                   
                    $('#rbookid').text(data.hotelGuestDetails[0].roomBookingId);
                    $('#title').text(data.hotelGuestDetails[0].guestName);
                    $('#name').text(data.hotelGuestDetails[0].guestName);
                    $('#dmainname').text(data.hotelGuestDetails[0].guestName);
                    $('#mobile').text(data.hotelGuestDetails[0].mobile);
                    $('#email').text(data.hotelGuestDetails[0].email);
                    $('#gender').text(data.hotelGuestDetails[0].gender);
                    $('#age').text(data.hotelGuestDetails[0].age);
                    $('#country').text(data.hotelGuestDetails[0].country);
                    $('#city').text(data.hotelGuestDetails[0].city);
                    $('#addr').text(data.hotelGuestDetails[0].address);


                    $('#nightstayed').text(data.hotelGuestDetails[0].nightStayed);
                    $('#lastvisit').text(data.hotelGuestDetails[0].lastVisit);
                    
                    if (data.addOnGuestDetails1 != null) {
                        if (data.addOnGuestDetails1.length > 0) {
                            showAddOnDetails.style.display = "block";
                            showAddOnDetailsDoc.style.display = "block";
                            // Populate the "addOnGuestDetails1" data
                            const addOnGuestDetails = data.addOnGuestDetails1;
                            addOnGuestListElement.innerHTML = "";
                            for (const guest of addOnGuestDetails) {
                                const listItem = document.createElement("li");
                                listItem.textContent = `Relation: ${guest.relationWithGuest}, Name: ${guest.guestName}`;
                                addOnGuestListElement.appendChild(listItem);
                            }

                            const addOnGuestDetailsDoc = data.addOnGuestDetails1;
                            addOnGuestDocElement.innerHTML = "";
                            for (const guestDoc of addOnGuestDetailsDoc) {

                                for (let i = 0; i < data.addOnGuestDetails1.length; i += 2) {
                                    const row = document.createElement('div');
                                    row.className = 'row';
                                    const column1 = document.createElement('div');
                                    column1.className = 'col-md-6';

                                    // Create a div element for the image name
                                    const imageName = document.createElement('div');
                                    imageName.className = 'image-name';
                                    imageName.textContent = guestDoc.guestName;


                                    const img1 = document.createElement('img');
                                    if (guestDoc.guestPhoto != null) {
                                        img1.src = "data:image/jpeg;base64," + guestDoc.guestPhoto;
                                    }
                                    else {
                                        img1.src = default_img;
                                    }
                                    img1.alt = `Image ${i + 1}`;
                                    img1.style.width = '100%';
                                    column1.appendChild(imageName);
                                    column1.appendChild(img1);
                                    row.appendChild(column1);

                                    if (i + 1 < data.addOnGuestDetails1.length) {
                                        const column2 = document.createElement('div');
                                        column2.className = 'col-md-6';
                                        // Create a div element for the image name
                                        const imageName = document.createElement('div');
                                        imageName.className = 'image-name';
                                        imageName.textContent = guestDoc.guestName;

                                        const img2 = document.createElement('img');
                                        if (guestDoc.guestIdPhoto != null) {
                                            img2.src = "data:image/jpeg;base64," + guestDoc.guestIdPhoto;
                                        }
                                        else {
                                            img2.src = default_img;
                                        }

                                        img2.alt = `Image ${i + 2}`;
                                        img2.style.width = '100%';
                                        column2.appendChild(imageName);
                                        column2.appendChild(img2);
                                        row.appendChild(column2);
                                    }

                                    addOnGuestDocElement.appendChild(row);
                                }


                            }


                        } 
                        else
                        {
                            showAddOnDetails.style.display = "none";
                            addOnGuestListElement.innerHTML = "";
                        }

                    }
                   
                    

                   
                },
                error: function (error) {
                    console.error('Error fetching data:', error);
                },
            });
        });

     
        //Code for click on different tabs

        $(".tabs").click(function () {

            $(".tabs").removeClass("active");
            $(".tabs h6").removeClass("font-weight-bold");
            $(".tabs h6").addClass("text-muted");
            $(this).children("h6").removeClass("text-muted");
            $(this).children("h6").addClass("font-weight-bold");
            $(this).addClass("active");

            current_fs = $(".active");

            next_fs = $(this).attr('id');
            next_fs = "#" + next_fs + "1";

            $("fieldset").removeClass("show");
            $(next_fs).addClass("show");

            current_fs.animate({}, {
                step: function () {
                    current_fs.css({
                        'display': 'none',
                        'position': 'relative'
                    });
                    next_fs.css({
                        'display': 'block'
                    });
                }
            });
        });
       

        $('.cardDeatils').hide();
        $('.cardDeatils:first').show();

        var table = $('#example').DataTable({
            searching: false, paging: false, info: false,autoWidth:false

        });//End of create main table

        $('#guestTable').DataTable({
           // dom: 'Bfrtip',
            searching: true, paging: false, info: false, autoWidth: false,
        //     buttons: [
           
        //     {
        //         extend:    'excelHtml5',
        //         text:      '<img src="/Areas/Department/Content/Images/Icons/excel.jpg" style="width:30px;border:none"/>',
        //         titleAttr: 'Excel'
        //     },
           
            
        //      {
        //         extend:    'pdfHtml5',
        //         text:      '<img src="/Areas/Department/Content/Images/Icons/Icon_pdf_file.svg.png" style="width:25px;border:none"/>',
        //         titleAttr: 'PDF'
        //     }
        // ]

        });//End of create main table

      


    });
    // var map;

    // function initMap() {
    //    // const { Map } = await google.maps.importLibrary("maps");

    //     map = new Map(document.getElementById("map"), {
    //         center: { lat: 21.1458, lng: 79.0882 },
    //         zoom: 8,
    //     });
    // }

    // initMap();
      function animateModalClose() {
            var modal = document.getElementById('resultModal');
            modal.classList.add('fade-out');
            setTimeout(function () {
                $('#resultModal').modal('hide');
                modal.classList.remove('fade-out');
            }, 500);
        }




    var map;
    function initMap() {
        debugger;
        var locations = @Html.Raw(JsonConvert.SerializeObject(Model.hotelLocOnDashboards));

        var mapOptions = {
            center: new google.maps.LatLng(locations[0].lat, locations[0]._long),
            zoom: 20,
            mapTypeId: google.maps.MapTypeId.ROADMAP
        };
        var map = new google.maps.Map(document.getElementById("map"), mapOptions);

        var infowindow = new google.maps.InfoWindow();
        bounds = new google.maps.LatLngBounds();
        var marker, i;
        // Specify the icon size using the iconSize property
        var customIcon = {
            url: '../../images/pin-point.png', // Specify the URL to your custom marker icon
            scaledSize: new google.maps.Size(32, 32), // Set the size of the icon (e.g., 32x32 pixels)
        };

        if (locations.length > 0) {
            // Calculate the center point
            var centerLat = 0;
            var centerLng = 0;

            locations.forEach(function (location) {
                centerLat += location.lat;
                centerLng += location._long;
            });

            centerLat /= locations.length;
            centerLng /= locations.length;

            // Set the map center to the calculated center point
            map.setCenter({ lat: centerLat, lng: centerLng });
        }

        for (i = 0; i < locations.length; i++) {
            marker = new google.maps.Marker({
                position: new google.maps.LatLng(locations[i].lat, locations[i]._long),
                map: map,

                icon: customIcon,
                // label: {
                //     text: locations[i].hotelName,
                //     color: "black",
                //     fontWeight: "bold",
                //     fontSize: "13px",
                //     margin: "55px"
                // }
            });

            loc = new google.maps.LatLng(locations[i].lat, locations[i]._long),

                bounds.extend(loc);

            //New Marker Click
            google.maps.event.addListener(marker, 'click', (function (marker, i) {
                return function () {

                    var latlng = new google.maps.LatLng(locations[i].lat, locations[i]._long);
                    var geocoder = geocoder = new google.maps.Geocoder();
                    geocoder.geocode({ 'latLng': latlng }, function (results, status) {
                        if (status == google.maps.GeocoderStatus.OK) {

                            if (results[0]) {
                                //alert("Location: " + results[1].formatted_address);
                                var address = results[0].formatted_address;
                                infowindow.setContent('<div class=infowindow> <h3>' + locations[i].hotelName + '</h3><h5><b>Details:</b></h5><p><b>Mobile:</b>' + locations[i].Mobile + '</div>');
                                infowindow.open(map, marker);
                            }
                            else {
                                var address = "Not Mention";
                                infowindow.setContent('<div class=infowindow> <h3>' + locations[i].hotelName + '</h3><h5><b>Details:</b></h5><p><b>Mobile:</b>' + locations[i].Mobile + '</div>');
                                infowindow.open(map, marker);
                            }
                        }
                        else {
                            infowindow.setContent('<div class=infowindow> <h3>' + locations[i].hotelName + '</h3><h5><b>Details:</b></h5><p><b>Mobile:</b>' + locations[i].Mobile + '</div>');
                            infowindow.open(map, marker);
                        }
                    });


                }
            })(marker, i));



        }

        map.fitBounds(bounds);
        map.panToBounds(bounds);
    }
        //google.maps.event.addDomListener(window, 'load', initMap);


        // function logout() {
        //     debugger;

        //     $.ajax({
        //         type: "post",
        //         url: "../Account/DepartLogout",
        //         datatype: "json",
        //         traditional: true,
        //         success: function (data) {
        //             console.log(data);
        //             window.location.href = '../Account/DepartmentLogin';

        //         }
        //     });
        // }


         document.getElementById("downloadButton").addEventListener("click", function() {
        debugger;
        // Replace 'yourRidValue' with the actual 'rid' parameter value you want to pass
        const rid = document.getElementById("rbookid").innerText;

        fetch(`/Department/DepartmentHome/DownloadGuestDetailsPDF?rid=${rid}`, {
            method: 'GET',
        })
        .then(response => {
            // Check if the response is successful
            if (!response.ok) {
                throw new Error(`HTTP error! Status: ${response.status}`);
            }
            return response.blob();
        })
        .then(blob => {
            // Create a blob URL for the PDF content
            const url = window.URL.createObjectURL(blob);

            // Create an anchor element to trigger the download
                const a = document.createElement('a');
                a.href = url;
                const filename = document.getElementById("dmainname").innerText;
                a.download = filename+'.pdf';

            // Display the PDF in the iframe
               
                // const pdfPreview = document.getElementById('pdfPreview');
                // pdfPreview.src = url;
                // pdfPreview.style.display = 'block';

            // Trigger a click event on the anchor element to initiate the download
            a.click();

            // Clean up resources
            window.URL.revokeObjectURL(url);
        })
        .catch(error => {
            console.error('Error:', error);
        });
    });
</script>